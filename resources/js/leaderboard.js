var theUrl="https://script.google.com/macros/s/AKfycbwg46p8shI9z5uGQV33n-DP-Mgblo2zgUb969NmeYbmAnThnA/exec",tempStorage="",sender="leaderb";window.addEventListener("message",receiveMessage,!1);function receiveMessage(a){a=JSON.parse(a.data);"sync"==a.name&&start();"storage"==a.name&&(tempStorage=a.value,logged())}function logged(){try{var a=JSON.parse(atob(tempStorage))}catch(b){a={key:null}}a.key?($("#accedi").hide(),$("#stats").show()):($("#accedi").show(),$("#stats").hide())}
function start(){syncData();requestStorage()}function requestStorage(){window.parent.postMessage(JSON.stringify({name:"getStorage",value:0,sender:sender}),"*")}$("#accedi-btn").click(function(){window.parent.postMessage('{"name":"apriLogin"}',"*");window.parent.postMessage('{"name":"chiudiLeaderboard"}',"*")});$(window).on("load",syncData);
function syncData(){syncCountApi();document.getElementById("container").style.display="none";document.getElementById("loading").style.display="block";var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var b=JSON.parse(atob(a.responseText));if(0<b.rank.length){for(var d='<div class="table" id="comunale">',c=0;c<b.rank.length;c++){var e='<div class="row">';e+='<div class="rank">'+(c+1)+"</div>";var f=13<b.rank[c].n.length?b.rank[c].n.slice(0,13)+"...":b.rank[c].n;
e+='<div><div class="main">'+f+"</div>";e+="<div class='score'>"+fPunto(b.rank[c].s)+"</div></div></div>";d+=e}d+="</div>"}else d="<p>Nulla da mostrare</p>";document.getElementById("clasComunale").innerHTML=d;document.getElementById("container").style.display="block";document.getElementById("loading").style.display="none"}};a.onprogress=function(b){b.lengthComputable&&console.log(b.loaded/b.total*100)};a.open("POST",theUrl,!0);a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
a.send(btoa(JSON.stringify({h:"c"})))}function fPunto(a){return a.toLocaleString("it",{useGrouping:!0})}document.getElementById("chiudi").addEventListener("click",function(){window.parent.postMessage('{"name":"chiudiLeaderboard"}',"*")});document.getElementById("aggiorna").addEventListener("click",syncData);$("#comunale-btn").click(function(){$([document.documentElement,document.body]).animate({scrollTop:$("#clasComunale").offset().top-80},600)});
$("#regionale-btn").click(function(){$([document.documentElement,document.body]).animate({scrollTop:$("#clasGenerale").offset().top-80},600)});$("#players-btn").click(function(){$([document.documentElement,document.body]).animate({scrollTop:$("#clasPlayers").offset().top-80},600)});
function syncCountApi(){$.getJSON("https://api.countapi.xyz/get/giusreds.github.io/PettolePlay",function(a){$("#PettolePlay").text(fPunto(a.value))});$.getJSON("https://api.countapi.xyz/get/giusreds.github.io/PettoleDegustate",function(a){$("#PettoleDegustate").text(fPunto(a.value))})};